

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=dark>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="友纪V-λOP">
  <meta name="keywords" content="">
  
    <meta name="description" content="Nest is a framework for building efficient and scalable Nodejs server-side applications. Learn Nest is essential for js full-stack developer.">
<meta property="og:type" content="article">
<meta property="og:title" content="Learn Nest 1: Controller">
<meta property="og:url" content="http://example.com/2022/11-02Learn-Nest-1-controller.html">
<meta property="og:site_name" content="友纪V-λOP">
<meta property="og:description" content="Nest is a framework for building efficient and scalable Nodejs server-side applications. Learn Nest is essential for js full-stack developer.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://docs.nestjs.com/assets/Controllers_1.png">
<meta property="article:published_time" content="2022-11-02T15:30:22.000Z">
<meta property="article:modified_time" content="2023-11-12T03:44:40.304Z">
<meta property="article:author" content="友纪V-λOP">
<meta property="article:tag" content="JS全栈">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://docs.nestjs.com/assets/Controllers_1.png">
  
  
  <title>Learn Nest 1: Controller - 友纪V-λOP</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/atom-one-dark.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"#"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":false,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>友纪V-λOP的blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Learn Nest 1: Controller">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-11-02 23:30" pubdate>
        2022年11月2日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      8.3k 字
    </span>
  

  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Learn Nest 1: Controller</h1>
            
            <div class="markdown-body">
              <p>Nest is a framework for building efficient and scalable Nodejs server-side applications, It supports Typescript, and combines with OOP, FP and FRP paradigm. Nest is based on low-level HTTP Server framework (Express or Fastify), but provides a higher level of abstraction and many interesting features like Dependency Injection, module (for better responsibility division), controller definement (based on decorator) and etc for better biz coding.</p>
<p>There are several concept in Nest—Controller, Provider, Module, Middleware, Exception Filter, Pipe, Custom Decorator, Guard, Interceptor—To learn these concept (and relationships between them) is to learn Nest.</p>
<hr>
<p>Controllers are responsible for handling incoming requests and returning response to the client, just like RESTful Controller in Spring MVC. <strong>Routing</strong> mechanism will controls which controller handle which requests. Frequently each controller has multiple routes and different routes can perform different actions.</p>
<p><img src="https://docs.nestjs.com/assets/Controllers_1.png"></p>
<h1 id="routes"><a href="#routes" class="headerlink" title="routes"></a>routes</h1><p><code>@Controller()</code> decorator is required to define a basic controller, it can accept a optional string as prefix to group a set of related routes. We can use decorators like <code>@Get()</code>, <code>@Post()</code>(named HTTP request method decorator) to define endpoint for HTTP request, which corresponds HTTP request method and route paths, such a route path is determined by concatenating controller’s prefix and path specified in method’s decorator. method decorated by such HTTP request method decorator is called request handler.</p>
<figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Controller</span>, <span class="hljs-title class_">Get</span>, <span class="hljs-title class_">Post</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/common&#x27;</span>;<br><br><span class="hljs-meta">@Controller</span>(<span class="hljs-string">&#x27;cats&#x27;</span>)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CatsController</span> &#123;<br>  <span class="hljs-meta">@Get</span>() <span class="hljs-comment">// mapping GET /cats</span><br>  <span class="hljs-title function_">findAll</span>(): <span class="hljs-built_in">string</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;This action returns all cats&#x27;</span>;<br>  &#125;<br><br>  <span class="hljs-meta">@Post</span>(<span class="hljs-string">&#x27;add&#x27;</span>) <span class="hljs-comment">// mapping POST /cats/add</span><br>  <span class="hljs-title function_">addCat</span>(): <span class="hljs-built_in">string</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;This action add new cat&#x27;</span>;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h1 id="two-ways-to-manipulating-response"><a href="#two-ways-to-manipulating-response" class="headerlink" title="two ways to manipulating response"></a>two ways to manipulating response</h1><p>When a request is made to this endpoint(such like ‘&#x2F;cats’), Nest will route the request to the user-defined method <code>findAll()</code>. Method name is completely arbitrary.</p>
<p>This method will return 200 status code and the plain response <code>&#39;This action returns all cats&#39;</code>, It may seems strange from the viewpoint of low-level HTTP framework like Express. It’s because that Nest employs two different option to manipulating response: Standard (recommended) or Library-specific.</p>
<p>Standard approach make use of request handler’s return value. when it returns a javascript object or array, it will be automatically serialized to JSON. when it returns primitive types like string, number, boolean, Nest will send just the value. status code is always 200 and POST requests will use 201, but this behavior can be modified by <code>@HttpCode(...)</code> decorator at handler-level (i.e. method level, <code>@Controller</code> is class-level).</p>
<p>If request handler use either <code>@Res()</code> or <code>@Next()</code>, Library-specific option will be chosen. Library-specific option use library’s native response object to handle response, which can be injected using <code>@Res()</code> decorator (e.g. <code>findAll(@Res() response: Response)</code>). With this approach, you have the ability to use native response handling methods exposed by the object, like <code>response.status(200).send()</code>.</p>
<p><strong>Return value also can be either Promise or Observable</strong>, It means that Nest supports and works well with Javascript asynchronous programming model.</p>
<h1 id="request-object"><a href="#request-object" class="headerlink" title="request object"></a>request object</h1><p>It’s often to access request details like query param and request body, we can access the request directly by instructing Nest to inject request object using <code>@Req()</code> decorator.</p>
<figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Controller</span>, <span class="hljs-title class_">Get</span>, <span class="hljs-title class_">Req</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/common&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Request</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span>;<br><span class="hljs-meta">@Controller</span>(<span class="hljs-string">&#x27;cats&#x27;</span>)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CatsController</span> &#123;<br>  <span class="hljs-meta">@Get</span>()<br>  <span class="hljs-title function_">findAll</span>(<span class="hljs-meta">@Req</span>() <span class="hljs-attr">request</span>: <span class="hljs-title class_">Request</span>): <span class="hljs-built_in">object</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">query</span>: request.<span class="hljs-property">query</span>,<br>      <span class="hljs-attr">body</span>: request.<span class="hljs-property">body</span>,<br>    &#125;;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>There are several dedicating decorators to grab specific properties from request object, It should be mentioned that request body is deserialized as JSON by default, and header name is case insensitive:</p>
<table>
<thead>
<tr>
<th align="left">Decorator</th>
<th align="left">corresponding object&#x2F;field</th>
<th align="center">type</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>@Request()</code>,<code>@Req()</code></td>
<td align="left"><code>req</code></td>
<td align="center"><code>Request</code></td>
</tr>
<tr>
<td align="left"><code>@Response()</code>, <code>@Res()</code></td>
<td align="left"><code>res</code></td>
<td align="center"><code>Response</code></td>
</tr>
<tr>
<td align="left"><code>@Nest()</code></td>
<td align="left"><code>next</code></td>
<td align="center"><code>Function</code></td>
</tr>
<tr>
<td align="left"><code>@Session()</code></td>
<td align="left"><code>req.session</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="left"><code>@Param()</code></td>
<td align="left"><code>req.params</code></td>
<td align="center"><code>Record&lt;string, string&gt;</code></td>
</tr>
<tr>
<td align="left"><code>@Param(key: string)</code></td>
<td align="left"><code>req.params[key]</code></td>
<td align="center"><code>undefined | string</code></td>
</tr>
<tr>
<td align="left"><code>@Body()</code></td>
<td align="left"><code>req.body</code></td>
<td align="center"><code>object</code></td>
</tr>
<tr>
<td align="left"><code>@Body(key: string)</code></td>
<td align="left"><code>req.body[key]</code></td>
<td align="center"><code>unknown</code></td>
</tr>
<tr>
<td align="left"><code>@Query()</code></td>
<td align="left"><code>req.query</code></td>
<td align="center"><code>Record&lt;string, string | string[]&gt;</code></td>
</tr>
<tr>
<td align="left"><code>@Query(key: string)</code></td>
<td align="left"><code>req.query[key]</code></td>
<td align="center"><code>undefined | string | string[]</code></td>
</tr>
<tr>
<td align="left"><code>@Headers()</code></td>
<td align="left"><code>req.headers</code></td>
<td align="center"><code>Record&lt;string, string&gt;</code></td>
</tr>
<tr>
<td align="left"><code>@Headers(key: string)</code></td>
<td align="left"><code>req.headers</code></td>
<td align="center"><code>undefined | string</code></td>
</tr>
<tr>
<td align="left"><code>@Ip()</code></td>
<td align="left"><code>req.ip</code></td>
<td align="center"><code>string</code></td>
</tr>
<tr>
<td align="left"><code>@HostParam()</code></td>
<td align="left"><code>req.hosts</code></td>
<td align="center"><code>object</code></td>
</tr>
</tbody></table>
<p>There is a tiny example below, It should be warned that type signature of parameters of request handler makes nonsense at runtime, thus type constraint should be guaranteed by programmers themselves (But we can use <code>ValidationPipe</code> to do this declaratively):</p>
<figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Body</span>, <span class="hljs-title class_">Controller</span>, <span class="hljs-title class_">Get</span>, <span class="hljs-title class_">Param</span>, <span class="hljs-title class_">Query</span>, <span class="hljs-title class_">Req</span>, <span class="hljs-title class_">Res</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/common&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Request</span>, <span class="hljs-title class_">Response</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; z &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;zod&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">AppService</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./app.service&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Numeric</span>, <span class="hljs-title class_">ZodValidator</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./configuration/ZodValidator&#x27;</span>;<br><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">SomeBody</span> = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br>&#125;;<br><br><span class="hljs-meta">@Controller</span>(<span class="hljs-string">&#x27;/learn&#x27;</span>)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppController</span> &#123;<br>  <span class="hljs-comment">// constructor injection</span><br>  <span class="hljs-comment">// can use @Inject to indicate Token</span><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> appService: AppService</span>) &#123;&#125;<br><br>  <span class="hljs-comment">// Get, Post, Delete...</span><br>  <span class="hljs-comment">// return primitive value</span><br>  <span class="hljs-meta">@Get</span>()<br>  <span class="hljs-title function_">getHello</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;hello&#x27;</span>;<br>  &#125;<br><br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/hello&#x27;</span>) <span class="hljs-comment">// define subroute</span><br>  <span class="hljs-title function_">anotherHello</span>(): <span class="hljs-built_in">any</span>[] &#123;<br>    <span class="hljs-comment">// array and object return as JSON</span><br>    <span class="hljs-keyword">return</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;hello&#x27;</span>];<br>  &#125;<br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/req&#x27;</span>)<br>  <span class="hljs-comment">// use Req, Request to inject Request Object, use Res, Response to inject Response Object</span><br>  <span class="hljs-title function_">getReq</span>(<span class="hljs-meta">@Req</span>() <span class="hljs-attr">req</span>: <span class="hljs-title class_">Request</span>): <span class="hljs-built_in">object</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">params</span>: req.<span class="hljs-property">query</span> &#125;;<br>  &#125;<br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/res&#x27;</span>)<br>  <span class="hljs-title function_">getRes</span>(<span class="hljs-meta">@Res</span>() <span class="hljs-attr">res</span>: <span class="hljs-title class_">Response</span>): <span class="hljs-built_in">string</span> &#123;<br>    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;send data by hand&#x27;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ss&#x27;</span>; <span class="hljs-comment">// will be ignore cause it&#x27;s library-specific option now</span><br>  &#125;<br>  <span class="hljs-comment">// other Decorator: Next, Session, Param, Body, Query, Headers, Ip...</span><br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/param/:name&#x27;</span>)<br>  <span class="hljs-comment">// typesafe should be maintained by hand</span><br>  <span class="hljs-title function_">param</span>(<br>    <span class="hljs-meta">@Param</span>(<span class="hljs-string">&#x27;name&#x27;</span>) <span class="hljs-attr">param</span>: <span class="hljs-built_in">string</span>,<br>    <span class="hljs-meta">@Query</span>() <span class="hljs-attr">allQueryParam</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span> | <span class="hljs-built_in">string</span>[]&gt;, <span class="hljs-comment">// get All Query Param</span><br>    <span class="hljs-meta">@Query</span>(<span class="hljs-string">&#x27;param&#x27;</span>) name?: <span class="hljs-built_in">string</span>,<br>  ): <span class="hljs-built_in">object</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123; param, name, allQueryParam &#125;;<br>  &#125;<br><br>  <span class="hljs-comment">// NO TYPE VALIDATION! It will accept any JSON object</span><br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/body&#x27;</span>)<br>  <span class="hljs-title function_">body</span>(<span class="hljs-params"><span class="hljs-meta">@Body</span>() body: SomeBody</span>) &#123;<br>    <span class="hljs-keyword">return</span> body;<br>  &#125;<br><br>  <span class="hljs-keyword">static</span> <span class="hljs-title class_">BodySchema</span> = z.<span class="hljs-title function_">object</span>(&#123;<br>    <span class="hljs-attr">name</span>: z.<span class="hljs-title function_">string</span>(),<br>    <span class="hljs-attr">age</span>: <span class="hljs-title class_">Numeric</span>(),<br>  &#125;);<br>  <span class="hljs-comment">// use pipe as Validation</span><br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/validBody&#x27;</span>)<br>  <span class="hljs-title function_">validBody</span>(<span class="hljs-params"></span><br><span class="hljs-params">    <span class="hljs-meta">@Body</span>(ZodValidator(AppController.BodySchema))</span><br><span class="hljs-params">    body: z.infer&lt;<span class="hljs-keyword">typeof</span> AppController.BodySchema&gt;,</span><br><span class="hljs-params">  </span>) &#123;<br>    <span class="hljs-keyword">return</span> body;<br>  &#125;<br><br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/id/:id&#x27;</span>)<br>  <span class="hljs-comment">// it will accept param like &#x27;123abc&#x27;</span><br>  <span class="hljs-title function_">paramType</span>(<span class="hljs-params"><span class="hljs-meta">@Param</span>(<span class="hljs-string">&#x27;id&#x27;</span>) id: <span class="hljs-built_in">number</span></span>) &#123;<br>    <span class="hljs-keyword">return</span> id + <span class="hljs-number">1</span>;<br>  &#125;<br><br>  <span class="hljs-comment">// promise and rxjs is supported</span><br>  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;/async&#x27;</span>)<br>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">asyncFn</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">2000</span>));<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;rua&#x27;</span>;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>With the above controller fully defined, Nest still doesn’t know that CatsController exists and as a result won’t create an instance of this class. There is no such a <code>@ComponentScan</code> in Nest :).</p>
<p>In Nest, Controllers always belong to a module, which is included in <code>controllers</code> array within <code>@Module()</code> decorator and we should include <code>CatsController</code> in any Modules as below.</p>
<figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Module</span>, <span class="hljs-title class_">NestModule</span>, <span class="hljs-title class_">MiddlewareConsumer</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/common&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">CatsController</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./cats.controller&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">LoggerMiddleware</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./LoggerMiddleware&#x27;</span>;<br><br><span class="hljs-meta">@Module</span>(&#123;<br>  <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">CatsController</span>],<br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CatsModule</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">NestModule</span> &#123;<br>  <span class="hljs-title function_">configure</span>(<span class="hljs-params">consumer: MiddlewareConsumer</span>) &#123;<br>    consumer.<span class="hljs-title function_">apply</span>(<span class="hljs-title class_">LoggerMiddleware</span>).<span class="hljs-title function_">forRoutes</span>(<span class="hljs-string">&#x27;/&#x27;</span>);<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>使用英语写笔记是一个尝试，最开始的时候肯定是大范围地照抄文档，但也要不断学习更多表述，并不断尝试复述，先把量堆上去。</p>
<ul>
<li>is responsible for, 负责</li>
</ul>
<p>Controller is responsible for handling incoming request and returning responses to the client.</p>
<ul>
<li>sth’s purpose is to do sth, …的用途是…</li>
</ul>
<p>A controller’s purpose is to receive specific requests for the application.</p>
<ul>
<li>The main idea of … is that …，……的用途&#x2F;意义&#x2F;特点是……</li>
</ul>
<p>The main idea of Provider is that it can be injected as a dependency.</p>
<ul>
<li>sth is required to do sth, …对…是必需的</li>
</ul>
<p><code>@Controller</code> decorator is required to define a basic controller.</p>
<ul>
<li>perform action, 执行操作</li>
<li>corresponds to&#x2F;with, 同…相一致</li>
<li>corresponding，对应的</li>
<li>is determined by, 由什么决定&#x2F;得出</li>
<li>sth specified in, 在…里给定的，同 given from&#x2F;by？</li>
</ul>
<p>Route path is determined by concatenating controller’s prefix and path specified in method’s decorator.</p>
<ul>
<li>employ, 采用（观点），对应 adopt（采用方法）？</li>
</ul>
<p>Nest will employ two different option to manipulating response.</p>
<ul>
<li>behavior，行为；feature，特性；mechanism，机制；function，功能</li>
<li>with this approach, 使用这种方式&#x2F;在这种情况下……</li>
<li>with …，随着，之后</li>
</ul>
<p>with the above controller fully defined, …</p>
<ul>
<li>as a result …，因此，thus</li>
<li>have the ability to，有能力做某事</li>
<li>instruct，命令，要求</li>
</ul>
<h1 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h1><ul>
<li><a target="_blank" rel="noopener" href="https://docs.nestjs.com/controllers">https://docs.nestjs.com/controllers</a></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/JS%E5%85%A8%E6%A0%88/">JS全栈</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-NC-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/11-13staffTrainingNote_1.html">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">五线谱练习应用开发笔记 1——需求以及技术选型</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10-08blogDevNote_1.html">
                        <span class="hidden-mobile">博客项目开发笔记 1——技术选型</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>





  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<!-- hexo injector body_end start -->
<script src="/assets/prism-bundle.js"></script>
<script src="/assets/prism-plus.js" data-pjax=""></script>
<!-- hexo injector body_end end --></body>
</html>
